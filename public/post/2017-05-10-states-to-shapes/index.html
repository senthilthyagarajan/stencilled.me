<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css integrity=sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB crossorigin=anonymous><link href="https://fonts.googleapis.com/css?family=Ubuntu|Ubuntu+Mono" rel=stylesheet><title>States to Shapes</title>
<link rel=stylesheet href=/css/stylesheet.css><script async src="https://www.googletagmanager.com/gtag/js?id=UA-91161205-1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-91161205-1")</script></head><body><div class=container-fluid><nav class="navbar navbar-expand-md navbar-light"><span class="navbar-brand mb-0 h1"></span>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarNavAltMarkup aria-controls=navbarNav aria-expanded=false aria-label="Toggle Navigation" name=button>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarNavAltMarkup><div class=navbar-nav><a class="nav-item nav-link" href=/>Home</a>
<a class="nav-item nav-link" href=https://github.com/senthilthyagarajan target=_blank>GitHub</a>
<a class="nav-item nav-link" href=/page/about/>About</a>
<a class="nav-item nav-link" href=/page/resume/>Resume</a>
<a class="nav-item nav-link" href=/page/blogroll/>Blogroll</a>
<a class="nav-item nav-link" href=/page/reading/>Reading</a>
<a class="nav-item nav-link" href=https://twitter.com/TheRascala>Twitter</a></div></div></nav><section id=page-title><h1><a href=/>Stencilled</a></h1><span id=author-name><h6><a href=/page/about/></a></h6></span></section><div class=blog-post><h1>States to Shapes</h1><div class=blog-post-subheader></div><div class=blog-post-content><html><head><style>body{margin:0;font-family:helvetica neue,sans-serif}.state-path{fill:#ccc;stroke:#fff;stroke-width:5px}.state-label{font-size:.65em}</style></head><body step=0><script src=https://d3js.org/d3.v4.min.js></script><script src=polylabel.js></script><script>var obj,width=window.innerWidth,height=window.innerHeight,duration=1e3,color=d3.scaleOrdinal(d3.schemeCategory10),svg=d3.select("body").append("svg").attr("width",width).attr("height",height);d3.json("us.json",function(e){var t,s=centerZoom(e),n=[];e.features.forEach(function(e){n.push({id:e.properties.state,count:e.properties.count,geom:e.geometry})}),t=parse(n,s).sort(function(e,t){return t.area-e.area}),t.forEach(function(e){var t=drawPath(e).attr("d",e.d0);drawLabels(e,0,0)}),d3.interval(function(){var e=stepUpdate();stepChange(e[0],e[1],t)},duration*2)});function centerZoom(e){var n=1,s=[width/2,height/2],o=d3.geoAlbersUsa().scale(n).translate(s),t=d3.geoPath().projection(o).bounds(e),i=n*width/(t[1][0]-t[0][0]),a=n*height/(t[1][1]-t[0][1]),n=i<a?i:a,s=[width-(t[0][0]+t[1][0])/2,height-(t[0][1]+t[1][1])/2],o=d3.geoAlbersUsa().scale(n).translate(s);return o}function drawLabels(e,t,n){var s=polylabel([e["coordinates"+t]],1),o=polylabel([e["coordinates"+n]],1);svg.append("text").attr("class","state state-label").attr("x",s[0]).attr("y",s[1]).attr("dy","0.35em").attr("text-anchor","middle").text(e.id).transition().duration(duration).attr("x",o[0]).attr("y",o[1])}function drawPath(e){var t=svg.append("path").attr("class","state state-path").attr("id",e.id).style("fill",function(){return color([e.count])});return t}obj={};function parse(e,t){var n=[];return e.forEach(function(e){obj={},obj.id=e.id,obj.count=e.count,obj.coordinates0=e.geom.coordinates[0].map(t),obj.coordinates1=square(obj.coordinates0)[0],obj.d0="M"+obj.coordinates0.join("L")+"Z",obj.d1="M"+obj.coordinates1.join("L")+"Z",obj.area=square(obj.coordinates0)[1],n.push(obj)}),n}function square(e){var n,s,o,i,a,r,t=obj.count*obj.count*20;return t<0?t=t*-1:t=t,s=Math.sqrt(t)/2.5,n=d3.polygonCentroid(e),o=n[0],i=n[1],a=e.length,r=squareCoords(o,i,s,a),[r,t]}function squareCoords(e,t,n,s){for(var i=[],a=[e-n,t-n],r=[e+n,t-n],c=[e+n,t+n],l=[e-n,t+n],o=0;o<s/4;o++)i.push(c);for(o=0;o<s/4;o++)i.push(l);for(o=0;o<s/4;o++)i.push(a);for(o=0;o<s/4;o++)i.push(r);return i}function stepChange(e,t,n){d3.selectAll(".state").remove(),n.forEach(function(n){transitionPath(drawPath(n),n["d"+e],n["d"+t],duration),drawLabels(n,e,t)})}function stepUpdate(){var e=+d3.select("body").attr("step"),t=e==0?1:0;return d3.select("body").attr("step",t),[e,t]}function transitionPath(e,t,n,s){e.attr("d",t).transition().duration(s).attr("d",n)}</script></body></html></div></div><footer><hr><small>&copy; 2025 .
Powered by <a href=https://gohugo.io/ target=_blank>Hugo</a> using the <a href=https://github.com/arjunkrishnababu96/basics target=_blank>Basics</a> theme | <a href=http://www.stencilled.me/index.xml target=_blank>RSS Feeds</a></small></footer></div><script src=https://code.jquery.com/jquery-3.3.1.slim.min.js integrity=sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js integrity=sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49 crossorigin=anonymous></script><script src=https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js integrity=sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T crossorigin=anonymous></script></body></html>